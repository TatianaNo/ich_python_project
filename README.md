# Проект поиска фильмов

> ⚠️ Данный файл README.md был сгенерирован автоматически с помощью GitHub Copilot.

Интерактивное консольное приложение для поиска фильмов с использованием MySQL и MongoDB.

## Быстрый старт

### Подготовка окружения

1. **Создание виртуального окружения:**
   ```bash
   python -m venv .venv
   ```

2. **Активация окружения:**
   - Windows (PowerShell): `./.venv/Scripts/activate`
   - Windows (CMD): `.venv\Scripts\activate.bat`
   - Linux/Mac: `source .venv/bin/activate`

3. **Установка зависимостей:**
   ```bash
   pip install -r requirements.txt
   ```

### Настройка базы данных

1. **Создайте файл `.env`** на основе `.env.example`:
   ```bash
   cp .env.example .env
   ```

2. **Настройте переменные окружения** в файле `.env`:
   ```env
   MONGO_HOST=localhost
   MONGO_PORT=27017
   MONGO_DB_NAME=films_database
   MONGO_USERNAME=your_username
   MONGO_PASSWORD=your_password
   MYSQL_HOST=localhost
   MYSQL_PORT=3306
   MYSQL_DB_NAME=your_mysql_db
   MYSQL_USERNAME=your_mysql_user
   MYSQL_PASSWORD=your_mysql_password
   ```

### Запуск приложения

```bash
python main.py
```

## Функциональность

### 1. Поиск фильмов

#### По ключевому слову
- Поиск по названию и описанию фильма (MySQL)
- Результат ограничен 10 фильмами за запрос
- Поддержка пагинации для просмотра дополнительных результатов

#### По жанру и диапазону годов
- Перед вводом пользователю показываются:
  - Список всех доступных жанров
  - Минимальный и максимальный год выпуска фильмов
- Возможность указать диапазон лет (например: 2005-2012) или конкретный год
- Поддержка пагинации

#### По актёру
- Поиск фильмов по части имени или фамилии актёра
- Показ жанра и года выпуска
- Поддержка пагинации

### 2. Сохранение запросов

Все поисковые запросы автоматически сохраняются в MongoDB (или в файл, если MongoDB недоступна):
- Коллекция: `search_queries`
- Включает: текст запроса, тип поиска, временную метку, количество результатов

### 3. Статистика запросов

- Отображение 5 самых популярных запросов по частоте использования
- Показ последних поисковых запросов

## Архитектура проекта

```
project/
├── main.py            # Главный файл приложения
├── db.py              # Модуль работы с базами данных
├── ui.py              # Модуль пользовательского интерфейса
├── settings.py        # Настройки и конфигурация
├── formatter.py       # Форматирование вывода
├── mongo_controler.py # Работа с MongoDB (логи и статистика)
├── mysql_controler.py # Работа с MySQL (фильмы)
├── requirements.txt   # Зависимости проекта
├── .env.example       # Пример файла окружения
└── README.md          # Документация
```

### Модули

- **`main.py`** — основной цикл приложения и координация модулей
- **`db.py`** — функции для работы с MongoDB и MySQL, кэширование соединений
- **`ui.py`** — пользовательский интерфейс и взаимодействие с консолью
- **`formatter.py`** — функции форматирования вывода
- **`mongo_controler.py`** — логирование и статистика поисковых запросов
- **`mysql_controler.py`** — поиск и подсчёт фильмов в MySQL
- **`settings.py`** — загрузка настроек из переменных окружения

## Технологии

- **Python 3.8+**
- **MySQL** — основная база данных фильмов
- **MongoDB** — хранение логов и статистики
- **PyMySQL** — драйвер для работы с MySQL
- **PyMongo** — драйвер для работы с MongoDB
- **python-dotenv** — загрузка переменных окружения
- **tabulate** — форматирование таблиц в консоли

## Структура данных

### Таблица фильмов (MySQL)
```json
{
  "title": "Название фильма",
  "release_year": 2023,
  "genre": "Драма",
  "rating": 8.5,
  "description": "Описание фильма"
}
```

### Коллекция запросов (MongoDB)
```json
{
  "_id": "ObjectId",
  "query": "поисковый запрос",
  "search_type": "keyword|genre_year|actor",
  "timestamp": "ISODate",
  "results_count": 5
}
```

## Дополнительные возможности

- **Кэширование соединений** — оптимизация производительности БД
- **Валидация ввода** — проверка корректности пользовательского ввода
- **Обработка ошибок** — корректная обработка исключений
- **Логирование запросов** — отслеживание активности пользователей
- **Падение на файл** — если MongoDB недоступна, логи сохраняются в файл

## Примечания

- Приложение поддерживает только русский язык интерфейса
- Все комментарии в коде написаны на английском языке
- Рекомендуется использовать MongoDB версии 4.0+ и MySQL 5.7+